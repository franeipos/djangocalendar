{% extends "base.html" %}

{% load static %}

{% block style %}
    <link rel="stylesheet" type="text/css" href="{% static '/my_calendar/calendar_base.css' %}">
{% endblock %}

{% block content %}
<div class="row justify-content-center text-center">
    <h1>
        {{ patient_calendar.name }}
    </h1>
</div>

<div class="row justify-content-center text-center my-5">
    <div class="col-3">
        <form method="post" action="">
            {% csrf_token %}
            <label for="month" class="form-label fw-bold fs-6">Seleccione el mes:</label>
            <input name="month" type="month" value="{{ year }}-{{ month }}" onchange="this.form.submit();" class="form-control">
        </form>
        <a href="{% url 'calendar-to-pdf' id_patient month year%}" class="btn btn-outline-success mt-3">Crear PDF</a>
    </div>
</div>


<table class="calendar mb-5 text-center">
    <tr>
        <td class="clickable" onclick="redirect_add_event('{% url 'add-event' 01 month year %}?id_patient={{id_patient}}&type=2')">
            <span class="date fw-bold">MES</span>
            <div class="calendar-event">
                {% if month_event %}
                    {% for event in month_event %}
                        <a class="fs-6" href="{% url 'event-detail' event.id %}"> {{event.title}} </a> <br>
                        {% if event.image is not None %}
                            <img src="{{ event.image.url}}">
                        {% endif %}
                    {% endfor %}
                {% endif %}
            </div>
        </td>
        <td class="clickable" onclick="redirect_add_event('{% url 'add-event' 01 month year %}?id_patient={{id_patient}}&type=3')">
            <span class="date fw-bold">ESTACIÓN</span>
            <div class="calendar-event">
                {% if season_event %}
                    {% for event in season_event %}
                        <a class="fs-6" href="{% url 'event-detail' event.id %}"> {{event.title}} </a> <br>
                            <img src="{{event.image.url}}">
                    {% endfor %}
                {% endif %}
            </div>
        </td>
        <td class="clickable" onclick="redirect_add_event('{% url 'add-event' 01 month year %}?id_patient={{id_patient}}&type=4')">
            <span class="date fw-bold">TIEMPO</span>
            <div class="calendar-event">
                {% if weather_event %}
                    {% for event in weather_event %}
                        <a class="fs-6" href="{% url 'event-detail' event.id %}"> {{event.title}} </a> <br>
                        {% if event.image %}
                            <img src="{{event.image.url}}">
                        {% endif %}
                    {% endfor %}
                {% endif %}
            </div>
        </td>
    </tr>
</table>

    {{ calendar }}

{% endblock content %}

<!-- TODO: Añadir institucion en registro.
Intentar crear plantillas distintas de calendarios. -->